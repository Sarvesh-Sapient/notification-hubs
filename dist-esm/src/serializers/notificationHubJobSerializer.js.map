{"version":3,"file":"notificationHubJobSerializer.js","sourceRoot":"","sources":["../../../src/serializers/notificationHubJobSerializer.ts"],"names":[],"mappings":"AAAA,uCAAuC;AACvC,kCAAkC;AAOlC,OAAO,EACL,kBAAkB,EAClB,mBAAmB,EACnB,SAAS,EACT,oBAAoB,EACpB,SAAS,GACV,MAAM,mBAAmB,CAAC;AAC3B,OAAO,EAAE,QAAQ,EAAE,YAAY,EAAE,MAAM,iBAAiB,CAAC;AACzD,OAAO,EAAE,yBAAyB,EAAE,MAAM,sBAAsB,CAAC;AAEjE;;;;;GAKG;AACH,MAAM,UAAU,gCAAgC,CAAC,KAAyB;IACxE,MAAM,GAAG,GAAwB;QAC/B,IAAI,EAAE,KAAK,CAAC,IAAI;QAChB,kBAAkB,EAAE,EAAE,OAAO,EAAE,KAAK,CAAC,kBAAkB,EAAE;QACzD,aAAa,EAAE,SAAS,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,EAAE,OAAO,EAAE,KAAK,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC,SAAS;KAC7F,CAAC;IAEF,MAAM,aAAa,GAAG,yBAAyB,CAAC,oBAAoB,EAAE,GAAG,CAAC,CAAC;IAE3E,OAAO,YAAY,CAAC,aAAa,EAAE,EAAE,QAAQ,EAAE,OAAO,EAAE,aAAa,EAAE,SAAS,EAAE,CAAC,CAAC;AACtF,CAAC;AAED;;;;GAIG;AACH,MAAM,CAAC,KAAK,UAAU,4BAA4B,CAAC,QAAgB;IACjE,MAAM,GAAG,GAAG,MAAM,QAAQ,CAAC,QAAQ,EAAE,EAAE,WAAW,EAAE,IAAI,EAAE,CAAC,CAAC;IAC5D,MAAM,OAAO,GAAG,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,kBAAkB,CAAC;IACrD,OAAO,wBAAwB,CAAC,OAAO,CAAC,CAAC;AAC3C,CAAC;AAED;;;;GAIG;AACH,MAAM,CAAC,KAAK,UAAU,2BAA2B,CAAC,QAAgB;IAChE,MAAM,GAAG,GAAG,MAAM,QAAQ,CAAC,QAAQ,EAAE,EAAE,WAAW,EAAE,IAAI,EAAE,CAAC,CAAC;IAC5D,MAAM,OAAO,GAAG,EAAE,CAAC;IACnB,KAAK,MAAM,IAAI,IAAI,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE;QACjC,OAAO,CAAC,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,CAAC;KACzE;IAED,OAAO,OAAO,CAAC;AACjB,CAAC;AAED,SAAS,2BAA2B,CAAC,OAA4B;IAC/D,MAAM,KAAK,GAA2B,EAAE,CAAC;IACzC,KAAK,MAAM,IAAI,IAAI,OAAO,CAAC,6BAA6B,CAAC,EAAE;QACzD,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC;KAC9C;IAED,OAAO,KAAK,CAAC;AACf,CAAC;AAED,SAAS,wBAAwB,CAAC,OAA4B;IAC5D,IAAI,gBAAoD,CAAC;IACzD,IAAI,SAAS,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,EAAE;QAC1C,gBAAgB,GAAG,2BAA2B,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,CAAC;KAC7E;IAED,IAAI,eAAmD,CAAC;IACxD,IAAI,SAAS,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,EAAE;QACzC,eAAe,GAAG,2BAA2B,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,CAAC;KAC3E;IAED,OAAO;QACL,KAAK,EAAE,oBAAoB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;QAC7C,IAAI,EAAE,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,MAAM,CAA2B;QAClE,MAAM,EAAE,oBAAoB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAA6B;QAC3E,QAAQ,EAAE,mBAAmB,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;QAClD,kBAAkB,EAAE,SAAS,CAAC,OAAO,CAAC,oBAAoB,CAAC,EAAE,oBAAoB,CAAC;QAClF,aAAa,EAAE,oBAAoB,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC;QAC7D,OAAO,EAAE,oBAAoB,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;QACjD,SAAS,EAAE,kBAAkB,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;QACnD,SAAS,EAAE,kBAAkB,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;QACnD,eAAe;QACf,gBAAgB;KACjB,CAAC;AACJ,CAAC","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport {\n  NotificationHubJob,\n  NotificationHubJobStatus,\n  NotificationHubJobType,\n} from \"../models/notificationHubJob.js\";\nimport {\n  getDateOrUndefined,\n  getFloatOrUndefined,\n  getString,\n  getStringOrUndefined,\n  isDefined,\n} from \"../utils/utils.js\";\nimport { parseXML, stringifyXML } from \"@azure/core-xml\";\nimport { serializeToAtomXmlRequest } from \"../utils/xmlUtils.js\";\n\n/**\n * @internal\n * Serializes a NotificationHubJob into an Atom XML entry.\n * @param entry - The NotificationHubJob to turn into an Atom XML entry.\n * @returns An Atom XML entry containing the notification hub job.\n */\nexport function serializeNotificationHubJobEntry(entry: NotificationHubJob): string {\n  const job: Record<string, any> = {\n    Type: entry.type,\n    OutputContainerUri: { __cdata: entry.outputContainerUrl },\n    ImportFileUri: isDefined(entry.importFileUrl) ? { __cdata: entry.importFileUrl } : undefined,\n  };\n\n  const requestObject = serializeToAtomXmlRequest(\"NotificationHubJob\", job);\n\n  return stringifyXML(requestObject, { rootName: \"entry\", cdataPropName: \"__cdata\" });\n}\n\n/**\n * Parses an Atom XML of an notification hub job entry.\n * @param bodyText - The incoming Atom XML entry to parse into a notification hub job.\n * @returns A parsed NotificationHubJob.\n */\nexport async function parseNotificationHubJobEntry(bodyText: string): Promise<NotificationHubJob> {\n  const xml = await parseXML(bodyText, { includeRoot: true });\n  const content = xml.entry.content.NotificationHubJob;\n  return createNotificationHubJob(content);\n}\n\n/**\n * Parses an Atom XML feed of notification hub jobs.\n * @param bodyText - The incoming Atom XML feed to parse into notification hub jobs.\n * @returns A list of notification hub jobs.\n */\nexport async function parseNotificationHubJobFeed(bodyText: string): Promise<NotificationHubJob[]> {\n  const xml = await parseXML(bodyText, { includeRoot: true });\n  const results = [];\n  for (const item of xml.feed.entry) {\n    results.push(createNotificationHubJob(item.content.NotificationHubJob));\n  }\n\n  return results;\n}\n\nfunction createInputOutputProperties(content: Record<string, any>): Record<string, string> {\n  const props: Record<string, string> = {};\n  for (const item of content[\"d3p1:KeyValueOfstringstring\"]) {\n    props[item[\"d3p1:Key\"]] = item[\"d3p1:Value\"];\n  }\n\n  return props;\n}\n\nfunction createNotificationHubJob(content: Record<string, any>): NotificationHubJob {\n  let outputProperties: Record<string, string> | undefined;\n  if (isDefined(content[\"OutputProperties\"])) {\n    outputProperties = createInputOutputProperties(content[\"OutputProperties\"]);\n  }\n\n  let inputProperties: Record<string, string> | undefined;\n  if (isDefined(content[\"InputProperties\"])) {\n    inputProperties = createInputOutputProperties(content[\"InputProperties\"]);\n  }\n\n  return {\n    jobId: getStringOrUndefined(content[\"JobId\"]),\n    type: getString(content[\"Type\"], \"type\") as NotificationHubJobType,\n    status: getStringOrUndefined(content[\"Status\"]) as NotificationHubJobStatus,\n    progress: getFloatOrUndefined(content[\"Progress\"]),\n    outputContainerUrl: getString(content[\"OutputContainerUri\"], \"outputContainerUrl\"),\n    importFileUrl: getStringOrUndefined(content[\"ImportFileUri\"]),\n    failure: getStringOrUndefined(content[\"Failure\"]),\n    createdAt: getDateOrUndefined(content[\"CreatedAt\"]),\n    updatedAt: getDateOrUndefined(content[\"UpdatedAt\"]),\n    inputProperties,\n    outputProperties,\n  };\n}\n"]}